{        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "background": "azure",
          "data": {
            "url": "https://raw.githubusercontent.com/Alina0029/hw10/main/bar_chart.csv"
          },
         "width": 700,
          "height": 400,
          "transform": [
            {"filter": "datum.total_deaths_per_million > 0"},
            {"filter": "datum.total_cases_per_million > 0"},
            {"filter": "datum.total_cases_per_million > 0"},
            {"calculate": "'China is the first country that discovered covid-19'",
            "as": "text_annotation"},
        {"calculate": "datum.location",
            "as": "text2"}
          ],
          
          "encoding": {
            "x": {
              "field": "total_cases_per_million",
              "type": "quantitative",
              "title": "Total cases per million",
              "axis": {"tickCount": 6},
              "scale": {"type": "log", "domain": [1,1000000]}
            },
            "y": {
              "field": "total_deaths_per_million",
              "type": "quantitative",
              "title": "Total deaths per million",
              "axis": {"tickCount": 4},
              "scale": {"type": "log", "domain": [1, 10000]}
            }
          },
          "layer": [
              {
              "mark": "circle",
              "params": [
          {
            "name": "continent_highl",
            "select": { "type": "point", "fields": ["continent"] },
            "bind": "legend"
          }],
              "encoding": {
                "size": {
                  "field": "population_density",
                  "type": "quantitative",
                  "title": "population density",
                  "scale": {
                    "type": "threshold", "domain": [10, 500,1000, 2000, 5000],
                    "range": [10, 50, 150, 200, 300, 400]
                  },
                  
                  "legend": {"format": ".1s"}
                  
                },
                
                "color": {
                  "field": "continent",
                  "type": "nominal",
                  "scale": {
                    "domain": [
                        "North America",
                        "South America",
                        "Europe",
                        "Africa",
                        "Asia",
                        "Oceania"
                      ],
                      "range": [
                        "#fb8072",
                        "#fdb462",
                        "#bebada",
                        "#b3b3b3",
                        "#80b1d3",
                        "#9e765f"
                      ]
                  }
                },
                "opacity": {
                  "condition": {"param": "continent_highl" , "value": 1}
                  ,
                  "value": 0.2
                },
                "tooltip": [
                  {"field": "location", "type": "nominal"},
                  {"field": "total_deaths_per_million", "type": "quantitative", "format": ".0f", "title": "Total deaths per million"},
                  {"field": "total_cases_per_million", "type": "quantitative", "format": ".0f", "title": "Total cases per million"},
                  {"field": "people_vaccinated_per_hundred", "type": "quantitative", "format": ".2f","title": "Vaccincation rate"},
                  {"field": "population_density", "type": "quantitative", "format": ".0f","title": "population density"}
                ]
              }
            },
                  {
            "mark": {
              "type": "text",
              "align": "right",
              "baseline": "middle",
              "dx": 10,
              "dy": -10,
              "fontSize": 10,
              "fontStyle": "italic"
            },
            "encoding": {
              "text": {"field": "text_annotation", "type": "nominal"},
              "color": {"value": "black"},
              "opacity": {
                "condition": {
                  "test": "datum['location'] == 'China'",
                  "value": 1
                },
                "value": 0
              },
                "tooltip": [
                  {"field": "location", "type": "nominal"},
                  {"field": "total_deaths_per_million", "type": "quantitative", "format": ".0f", "title": "Total deaths per million"},
                  {"field": "total_cases_per_million", "type": "quantitative", "format": ".0f", "title": "Total cases per million"},
                  {"field": "people_vaccinated_per_hundred", "type": "quantitative", "format": ".2f","title": "Vaccincation rate"},
                  {"field": "population_density", "type": "quantitative", "format": ".0f","title": "population density"}
                ]
            }
          },
                          {
            "mark": {
              "type": "text",
              "align": "right",
              "baseline": "middle",
              "dx": 60,
              "dy": 0,
              "fontSize": 10,
              "fontStyle": "italic"
            },
            "encoding": {
              "text": {"field": "text2", "type": "nominal"},
              "color": {"value": "black"},
              "opacity": {
                "condition": {
                  "test": "datum['location'] == 'Singapore'",
                  "value": 1
                },
                "value": 0
              },
                "tooltip": [
                  {"field": "location", "type": "nominal"},
                  {"field": "total_deaths_per_million", "type": "quantitative", "format": ".0f", "title": "Total deaths per million"},
                  {"field": "total_cases_per_million", "type": "quantitative", "format": ".0f", "title": "Total cases per million"},
                  {"field": "people_vaccinated_per_hundred", "type": "quantitative", "format": ".2f","title": "Vaccincation rate"},
                  {"field": "population_density", "type": "quantitative", "format": ".0f","title": "population density"}
                ]
            }
          },
                  {
            "mark": {
              "type": "text",
              "align": "right",
              "baseline": "middle",
              "dx": 30,
              "dy": 0,
              "fontSize": 10,
              "fontStyle": "italic"
            },
            "encoding": {
              "text": {"field": "text2", "type": "nominal"},
              "color": {"value": "black"},
              "opacity": {
                "condition": {
                  "test": "datum['location'] == 'Peru'",
                  "value": 1
                },
                "value": 0
              },
                "tooltip": [
                  {"field": "location", "type": "nominal"},
                  {"field": "total_deaths_per_million", "type": "quantitative", "format": ".0f", "title": "Total deaths per million"},
                  {"field": "total_cases_per_million", "type": "quantitative", "format": ".0f", "title": "Total cases per million"},
                  {"field": "people_vaccinated_per_hundred", "type": "quantitative", "format": ".2f","title": "Vaccincation rate"},
                  {"field": "population_density", "type": "quantitative", "format": ".0f","title": "population density"}
                ]
            }
          }
      ]
      }