{        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "data": {
      "url": "https://raw.githubusercontent.com/Alina0029/hw10/main/bar_chart.csv"
    },
    "background": "azure",
"hconcat": [
{
"width": 300,
"height": 400,
"title":{
  "text":"Vaccination situation in the world",
  "fontSize":15,
  "fontWeight":"bolder"
},
"data": {
    "url": "https://raw.githubusercontent.com/Alina0029/hw10/main/pie_data.csv"
},
"transform": [
    {
        "window": [{
            "op": "sum",
            "field": "people_vaccinated",
            "as": "Totalvacc"
        }],
        "frame": [null, null]
    },
    {
        "calculate": "datum.people_vaccinated/datum.Totalvacc * 100",
        "as": "presentage"
    }
],
      "encoding": {

    "theta": {
        "field": "presentage",
        "type": "quantitative",
        "aggregate": "sum",
        "stack": true
    },
    "color": {
        "scale": {
            "domain": [
                "North America",
                "South America",
                "Europe",
                "Africa",
                "Asia",
                "Oceania"
                            ],
            "range": [
                    "#fb8072",
                    "#fdb462",
                    "#bebada",
                    "#b3b3b3",
                    "#80b1d3",
                    "#9e765f"
            ]
        },
        "field": "continent",
        "type": "nominal"
    },
    "opacity": {
            "condition": {"param": "continent_highl", "value": 1},
            "value": 0.2
          },
          "tooltip": [
        { "field": "continent", "type": "nominal" },
        { "field": "people_vaccinated", "type": "quantitative","title":"Vaccinated people number"},
        { "field": "people_vaccinated_per_hundred", "type": "quantitative","title":"vaccination rate (%)"},
        { "field": "presentage", "type": "quantitative", "aggregate": "sum", "title": "presentage of total (%)", "format": ".2f" }
    ]
},
"layer": [{
        "mark": {
            "type": "arc",
            "outerRadius": 200,
            "innerRadius": 120
        },
         "params": [
    {
      "name": "continent_highl",
      "select": { "type": "point", "fields": ["continent"] },
      "bind": "legend"
    }]
    },
    
    {
        "mark": {
            "type": "text",
            "radius": 160,
            "fontSize": 15,
            "fill": "white"
        },
        "encoding": {
            "text": { "field": "presentage", "format": ".2f" }
        }
    },
    {
        "mark": {
            "type": "text",
            "fontSize": 20,
            "text": "Vaccinated Peopleï¼š",
            "fontWeight": "lighter",
            "baseline": "alphabetic",
            "dx":8,
            "y": 180,
            "fill": "black"
        }
    },
    {
        "mark": {
            "type": "text",
            "fontSize": 20,
            "fontWeight": "lighter",
            "baseline": "alphabetic",
            "y": 210,
            "fill": "black"
        },
        "encoding": {
            "text": { "field": "Totalvacc", "type": "quantitative" }

        }
    },
    {
        "mark": {
            "type": "text",
            "fontSize": 35,
            "baseline": "alphabetic",
            "y": 250,
            "text": "47%",
            "fill": "black"
        }
    },
              {
            "mark": {
              "type": "text",
              "align": "left",
              "baseline": "bottom",
              "dx": -135,
              "dy": 140,
              "fontSize": 12,
              "fontStyle": "italic",
              "text": "Aisa has the largest number of vaccinated people",
              "fill": "white"
            }
            },
         {
            "mark": {
              "type": "text",
              "align": "left",
              "baseline": "bottom",
              "dx": -120,
              "dy": 155,
              "fontSize": 12,
              "fontStyle": "italic",
              "text": "in the world, accounting for 68.04% of the",
            "fill": "#white"
            }},         {
            "mark": {
              "type": "text",
              "align": "left",
              "baseline": "bottom",
              "dx": -70,
              "dy": 170,
              "fontSize": 12,
              "fontStyle": "italic",
              "text": "world's vaccinated people.",
            "fill": "#white"
            }}

]
},
{"vconcat":[{"width": 260,
"height": 150,
   "data": {
      "url": "https://raw.githubusercontent.com/Alina0029/hw10/main/bar_1.csv"
    },
    "transform": [
      {"filter": "datum.people_vaccinated_per_hundred >0 "},
      {"filter": "datum.continent != 'European Union' "}

  ],
  "title": { "text": "Vaccination rate by continent" },
 "layer":[{ "mark": "bar", 
  "encoding": {
      "x": { "field": "people_vaccinated_per_hundred", "type": "quantitative",
              "axis": { "title": "vaccination rate(%)", "grid": false } ,"scale": {"type": "linear", "domain": [0,100]}},
      "y": { "field": "continent", "type": "nominal","sort": { "field": "people_vaccinated_per_hundred", "order": "descending" },
              "axis": { "title": ""} },
              "color": {
                "field": "continent",
                "type": "nominal",
                "scale": {
                  "domain": [
                    "North America",
                    "South America",
                    "Europe",
                    "Africa",
                    "Asia",
                    "Oceania"
                  ],
                  "range": [
                    "#fb8072",
                    "#fdb462",
                    "#bebada",
                    "#b3b3b3",
                    "#80b1d3",
                    "#9e765f"
                  ]
                }
              },
            "opacity": {
                "condition": {"param": "continent_highl", "value": 1},
                "value": 0.2
              },
          "tooltip": [{ "field": "continent", "type": "nominal" ,"title":"continent"},
        { "field": "people_vaccinated_per_hundred", "type": "quantitative","title":"vaccination rate(%)"}
    ]
  }}]
},
{"width": 260,
"height": 143,
   "data": {
      "url": "https://raw.githubusercontent.com/Alina0029/hw10/main/bar_chart.csv"
    },
    "transform": [
      { "filter": { "param": "continent_highl" } },
      {"filter": "datum.continent != '' "},
      {"window": [{"op": "rank","as": "rand"}],
        "sort": [{ "field": "people_vaccinated_per_hundred", "order": "descending" }]
      }, {
          "filter": "datum.rand <= 6"
      },
      {"filter": "datum.people_vaccinated_per_hundred >0 "}

  ],
  "title": { "text": "Top 6 vaccination rate locations" },
 "layer":[{ "mark": "bar", 
  "encoding": {
      "x": { "field": "people_vaccinated_per_hundred", "type": "quantitative",
              "axis": { "title": "Vaccination rate(%)", "grid": false },"scale": {"type": "linear", "domain": [0,100]} },
      "y": { "field": "location", "type": "nominal","sort": { "field": "people_vaccinated_per_hundred", "order": "descending" },
              "axis": { "title": ""} },
              "color": {
                "field": "continent",
                "type": "nominal",
                "scale": {
                  "domain": [
                    "North America",
                    "South America",
                    "Europe",
                    "Africa",
                    "Asia",
                    "Oceania"
                  ],
                  "range": [
                    "#fb8072",
                    "#fdb462",
                    "#bebada",
                    "#b3b3b3",
                    "#80b1d3",
                    "#9e765f"
                  ]
                }
              },
          "tooltip": [{ "field": "continent", "type": "nominal" },
        { "field": "location", "type": "nominal" },
        { "field": "people_vaccinated_per_hundred", "type": "quantitative","title":"vaccination rate(%)"}
    ]
  }}]
}]}
],
"config": {
    "view": {"stroke": null},
    "axis": {"grid": false}
  }
}