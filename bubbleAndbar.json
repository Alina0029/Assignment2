{        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "data": {
          "url": "https://raw.githubusercontent.com/Alina0029/hw10/main/bar_chart.csv"
        },
"hconcat": [
    {
        "width": 700,
        "height": 400,
        "transform": [
          {"filter": "datum.total_deaths_per_million > 0"},
          {"filter": "datum.total_cases_per_million > 0"},
          {"filter": "datum.total_cases_per_million > 0"},
          {"calculate": "'China is the first country to discover Covid-19'",
          "as": "text_annotation"}
        ],
        
        "encoding": {
          "x": {
            "field": "total_cases_per_million",
            "type": "quantitative",
            "title": "Total cases per million",
            "axis": {"tickCount": 6},
            "scale": {"type": "log", "domain": [1,1000000]}
          },
          "y": {
            "field": "total_deaths_per_million",
            "type": "quantitative",
            "title": "Total deaths per million",
            "axis": {"tickCount": 4},
            "scale": {"type": "log", "domain": [1, 10000]}
          }
        },
        "layer": [
            {
            "mark": "circle",
            "params": [
        {
          "name": "continent_highl",
          "select": { "type": "point", "fields": ["continent"] },
          "bind": "legend"
        }],
            "encoding": {
              "size": {
                "field": "population_density",
                "type": "quantitative",
                "title": "population density",
                "scale": {
                  "type": "threshold", "domain": [10, 500,1000, 2000, 5000],
                  "range": [10, 50, 150, 200, 300, 400]
                },
                
                "legend": {"format": ".1s"}
              },
              "color": {
                "field": "continent",
                "type": "nominal",
                "scale": {
                  "domain": [
                    "North America",
                    "South America",
                    "Europe",
                    "Africa",
                    "Asia",
                    "Oceania"
                  ],
                  "range": [
                    "#e41a1c",
                    "#984ea3",
                    "#ff7f00",
                    "#a6cee3",
                    "#377eb8",
                    "#a65628"
                  ]
                }
              },
              "opacity": {
                "condition": {"param": "continent_highl", "value": 1},
                "value": 0.2
              },
              "tooltip": [
                {"field": "location", "type": "nominal"},
                {"field": "total_deaths_per_million", "type": "quantitative", "format": ",", "title": "Total deaths per million"},
                {"field": "total_cases_per_million", "type": "quantitative", "format": ",", "title": "Total cases per million"},
                {"field": "total_vaccinations_per_hundred", "type": "quantitative", "format": ",","title": "Vaccincation per hundred"},
                {"field": "population_density", "type": "quantitative", "format": ",","title": "population density"}
              ]
            }
          },
          {
            "mark": {
              "type": "text",
              "align": "right",
              "baseline": "middle",
              "dx": -12,
              "fontSize": 10,
              "fontStyle": "italic"
            },
            "encoding": {
              "text": {"field": "text_annotation", "type": "nominal"},
              "color": {"value": "black"},
              "opacity": {
                "condition": {
                  "test": "datum['location'] == 'China'",
                  "value": 1
                },
                "value": 0
              },
              "tooltip": [
                {"field": "location", "type": "nominal"},
                {"field": "total_deaths_per_million", "type": "quantitative", "format": ",","title": "Total deaths per million"},
                {"field": "total_cases_per_million", "type": "quantitative", "format": ",","title": "Total cases per million"},
                {"field": "total_vaccinations_per_hundred", "type": "quantitative", "format": ",","title": "Vaccincation per hundred"},
                {"field": "population_density", "type": "quantitative", "format": ",","title": "population density"}
              ]
            }
          }
        ]
      },
    {
      "title": { "text": "Vaccinated People per 100 by country" },
      "mark": "bar", 
        "transform": [
          { "filter": { "param": "continent_highl" } },
          {"filter": "datum.continent != '' "},
          {"window": [{"op": "rank","as": "rand"}],
            "sort": [{ "field": "people_vaccinated_per_hundred", "order": "descending" }]
          }, {
              "filter": "datum.rand <= 20"
          },
          {"filter": "datum.people_vaccinated_per_hundred >0 "}
    
      ],
      "encoding": {
          "x": { "field": "people_vaccinated_per_hundred", "type": "quantitative",
                  "axis": { "title": "Vaccinated People per 100", "grid": false } },
          "y": { "field": "location", "type": "nominal","sort": { "field": "people_vaccinated_per_hundred", "order": "descending" },
                  "axis": { "title": ""} },
                  "color": {
                    "field": "continent",
                    "type": "nominal",
                    "scale": {
                      "domain": [
                        "North America",
                        "South America",
                        "Europe",
                        "Africa",
                        "Asia",
                        "Oceania"
                      ],
                      "range": [
                        "#e41a1c",
                        "#984ea3",
                        "#ff7f00",
                        "#a6cee3",
                        "#377eb8",
                        "#a65628"
                      ]
                    }
                  }
      }
    }
    ]
    }